# This configuration file was automatically generated by Gitpod.
# Please adjust to your needs (see https://www.gitpod.io/docs/introduction/learn-gitpod/gitpod-yaml)
# and commit this file to your remote git repository to share the goodness with others.

# Learn more from ready-to-use templates: https://www.gitpod.io/docs/introduction/getting-started/quickstart

ports:
  - name: vault
    port: 8201
    onOpen: open-browser
tasks:
  - name: dependencies
    before: |
      wget -O- https://apt.releases.hashicorp.com/gpg | sudo gpg --dearmor -o /usr/share/keyrings/hashicorp-archive-keyring.gpg
      echo "deb [signed-by=/usr/share/keyrings/hashicorp-archive-keyring.gpg] https://apt.releases.hashicorp.com $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/hashicorp.list
      sudo apt update && sudo apt install vault
    init: |
      ./starter.sh
  - name: spring_vault
    init: |
      sleep 15
      cd springcloudclient/javatodev_core_api_vault/
      mvn spring-boot:run
  - name: config-server
    init: |
      sleep 15
      cd springcloudserver/spring-cloud-config-server/
      mvn spring-boot:run
  - name: spring_config
    init: |
      sleep 20
      cd springcloudclient/javatodev_core_api_config/
      mvn spring-boot:run 

vscode:
  extensions:
    - ms-azuretools.vscode-docker

  #docker-compose exec db sh -c 'mysql -uapp -papppw ${MYSQL_DATABASE}'
  #docker-compose exec db sh -c 'mysql -uroot -p${MYSQL_ROOT_PASSWORD} ${MYSQL_DATABASE}'
  #mysql -uroot -pmauFJcuf5dhRMQrjj -h 127.0.0.1 -P 3306 -D javatodev_application_dev_db

#curl http://localhost:8888/javatodev_core_api/default | jq '.'
#curl --user config_admin:Pass_1234 http://localhost:8888/javatodev_core_api/dev | jq '.'


